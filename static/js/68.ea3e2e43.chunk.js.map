{"version":3,"sources":["app/Admin-components/Appointment/FetchAppoinments.js"],"names":["FetchAppoinments","history","useHistory","useCookies","cookies","setCookie","useState","itemlist","setitemlist","pageCount","setPageCount","itemOffset","setItemOffset","itemsPerPage","React","useForm","mode","register","handleSubmit","reset","formState","errors","isDirty","isValid","useEffect","getData","user","role","getAppoinmentsList","data","result","results","totalPages","getAppoinmentsListByUser","id","response","message","toast","error","process","code","formData","JSON","stringify","refreshToken","localStorage","getItem","path","userLogout","finally","push","className","aria-label","href","onClick","event","preventDefault","aria-current","map","item","name","Date","fromDate","toLocaleDateString","day","month","year","toDate","desc","onChange","e","UpdateAppoinments","target","value","success","autoClose","statusChanged","selected","status","showStatus","breakLabel","nextLabel","onPageChange","newOffset","forcePage","pageRangeDisplayed","previousLabel","renderOnZeroPageCount"],"mappings":"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","file":"static/js/68.ea3e2e43.chunk.js","sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { useCookies } from \"react-cookie\";\nimport ReactPaginate from \"react-paginate\";\nimport { getAppoinmentsList, getAppoinmentsListByUser, userLogout, UpdateAppoinments } from \"../../../utils/APIs\";\nimport { toast } from \"react-toastify\";\nimport { useHistory } from \"react-router-dom\";\nimport { useForm } from \"react-hook-form\";\nimport { Form } from 'react-bootstrap';\n\n\nconst FetchAppoinments = () => {\n  const history = useHistory()\n  const [cookies, setCookie] = useCookies([\"user\"]);\n  const [itemlist, setitemlist] = useState([]);\n  // We start with an empty list of items.\n  const [pageCount, setPageCount] = useState(0);\n  // Here we use item offsets; we could also use page offsets\n  // following the API or data you're working with.\n  const [itemOffset, setItemOffset] = useState(0);\n  const [itemsPerPage] = useState(20);\n  const [ setShow] = React.useState(false);\n  const [ setvalueToEdit] = useState({});\n\n  const { register, handleSubmit, reset, formState: { errors, isDirty, isValid } } = useForm({\n    mode: \"onChange\"\n  });\n\n  const [modelMode, setmodelMode] = useState('create')\n  const statusChanged = (id, e) => {\n    UpdateAppoinments({\n      \"appoinments_id\": id,\n      \"status\": e.target.value\n    })\n    toast.success('Status updated successfully', {\n      autoClose: true\n    })\n  }\n\n\n  const onSubmit = async (data) => {\n    const date1 = new Date(data?.date_from);\n    const date2 = new Date(data?.date_to);\n    const diffTime = Math.abs(date2 - date1);\n    const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));\n    //   if(modelMode === 'edit'){\n    //   try {\n    //     const formData = JSON.stringify({\n    //       leave_id: valueToEdit?.id,\n    //       user: data.user,\n    //       reason: data?.reason,\n    //       leave_status: data?.leave_status,\n    //       total_leave : diffDays,\n    //       date_from : new Date(data?.date_from).toISOString(),\n    //       date_to : new Date(data?.date_to).toISOString(),\n    //     });\n    //     await updateEmployeeLeave(formData)\n    // toast.success('Leave updated successfully',{\n    //   autoClose : true\n    // })\n    //   } catch (error) {\n    //     if (\n    //       error &&\n    //       error.response &&\n    //       error.response.data &&\n    //       error.response.data.message\n    //     ) {\n    //       toast.error(error.response.data.message);\n    //     } else {\n    //       toast.error(process.env.REACT_APP_ERROR_MESSAGE);\n    //     }\n    //   }\n    //   finally {\n    //     handleClose()\n    //     getData()\n    //   }\n    // }\n\n\n  };\n\n  const handleClose = () => {\n    setShow(false)\n    setvalueToEdit({})\n    reset()\n  };\n\n\n  const handleShow = (value, mode) => {\n    reset()\n\n    if (mode === 'edit') {\n      setvalueToEdit(value)\n      setmodelMode('edit')\n    }\n\n    if (mode === 'create') {\n      setvalueToEdit(value)\n      setmodelMode('create')\n    }\n    setShow(true);\n  }\n\n  useEffect(() => {\n    getData()\n  }, [itemOffset, itemsPerPage]);\n\n  // useEffect(() => {\n  //   getEmployeeData()\n  // }, []);\n\n  // const getEmployeeData = async () => {\n  //     try {\n  //       const result = await getAllEmployee()\n  //       setemployeeList(result.data.results)\n  //     } catch (error) {\n  //       getEmployeeData()\n  //     }\n  // }\n\n  const getData = async () => {\n    try {\n      if(cookies?.user?.role === 'admin'){\n        const result = await (await getAppoinmentsList(itemsPerPage, itemOffset)).data;\n        setitemlist(result?.results);\n        setPageCount(result?.totalPages);\n      }else{\n        const result = await (await getAppoinmentsListByUser(itemsPerPage, itemOffset,cookies?.user?.id)).data;\n        setitemlist(result?.results);\n        setPageCount(result?.totalPages);\n      }      \n      // console.log(\"res\", result?.results)\n      // Fetch items from another resources.\n      \n    } catch (error) {\n      if (\n        error?.response?.data?.message\n      ) {\n        toast.error(error.response.data.message);\n      } else {\n        toast.error(process.env.REACT_APP_ERROR_MESSAGE);\n      }\n\n      if (error?.response?.data?.code === 401) {\n        const formData = JSON.stringify({\n          refreshToken: localStorage.getItem('refreshToken'),\n        });\n        setCookie('user', null, { path: '/' });\n        userLogout(formData).finally(() => {\n          history.push('/user-pages/login-1')\n        })\n      }\n    }\n\n  }\n\n  // Invoke when user click to request another page.\n  const handlePageClick = (event) => {\n    const newOffset = (event.selected + 1);\n    setItemOffset(newOffset);\n  };\n\n  const showStatus = (status) => {\n    switch (+status) {\n      case (1):\n        return 'Processing';\n      case (2):\n        return 'Approved';\n      case (3):\n        return 'Rejected';\n      case (4):\n        return 'Successfull';\n      case (5):\n        return 'Terminated'\n      default:\n        return 'Processing';\n    }\n  }\n\n  return (\n    <div>\n      <div className=\"page-header\">\n        <h3 className=\"page-title\">Appoinments / Book Appoinment </h3>\n        <nav aria-label=\"breadcrumb\">\n          <ol className=\"breadcrumb\">\n            <li className=\"breadcrumb-item\">\n              <a href=\"!#\" onClick={(event) => event.preventDefault()}>\n                {cookies?.user?.role} Dashboard\n              </a>\n            </li>\n            <li className=\"breadcrumb-item active\" aria-current=\"page\">\n              Show Appoinment\n            </li>\n          </ol>\n        </nav>\n      </div>\n      <div className=\"col-lg-12 grid-margin stretch-card p0\">\n        <div className=\"card\">\n          <div className=\"card-body\">\n            <h4 className=\"card-title\">Show Appoinment</h4>\n\n            <div className=\"table-responsive\">\n              <table className=\"table table-striped\">\n                <thead>\n                  <tr>\n                    <th> User </th>\n                    <th> Date From </th>\n                    <th> Date To </th>\n                    <th> Description </th>\n                    <th> Status </th>\n                  </tr>\n                </thead>\n                <tbody>\n                  {itemlist?.map((item) => {\n                    return (\n                      <tr>\n                        <td>{item?.user?.name}</td>\n                        <td>{new Date(item?.fromDate)?.toLocaleDateString('en-GB', { day: 'numeric', month: 'short', year: 'numeric' })}</td>\n                        <td>{new Date(item?.toDate)?.toLocaleDateString('en-GB', { day: 'numeric', month: 'short', year: 'numeric' })}</td>\n                        <td>{item?.desc}</td>\n                        <td>{cookies?.user?.role === 'admin' ? (\n                          <select\n\n                            id={item.id}\n\n                            onChange={(e) => statusChanged(item.id, e)}\n                          >\n                            <option\n                              value=\"1\"\n                              selected={item.status == 1 ? \"selected\" : false}\n                            >\n                              Processing\n                            </option>\n                            <option\n                              value=\"2\"\n                              selected={item.status == 2 ? \"selected\" : false}\n                            >\n                              Approved\n                            </option>\n                            <option\n                              value=\"3\"\n                              selected={item.status == 3 ? \"selected\" : false}\n                            >\n                              Rejected\n                            </option>\n                            <option\n                              value=\"4\"\n                              selected={item.status == 4 ? \"selected\" : false}\n                            >\n                              Successfull\n                            </option>\n                            <option\n                              value=\"5\"\n                              selected={item.status == 5 ? \"selected\" : false}\n                            >\n                              Terminated\n                            </option>\n                          </select>\n                        ) : (\n                          showStatus(item.status)\n                        )}\n                        </td>\n\n\n\n                      </tr>\n                    );\n                  })}\n                </tbody>\n              </table>\n              <ReactPaginate\n                breakLabel=\"...\"\n                nextLabel=\"next >\"\n                className=\"client-list\"\n                onPageChange={handlePageClick}\n                forcePage={0}\n                pageRangeDisplayed={5}\n                pageCount={pageCount}\n                previousLabel=\"< previous\"\n                renderOnZeroPageCount={null}\n              />\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default FetchAppoinments;\n"],"sourceRoot":""}